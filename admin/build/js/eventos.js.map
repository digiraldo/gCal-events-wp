{"version":3,"sources":["eventos.js"],"names":["maxitem","now","Date","toJSON","actual","espXmas","espXnada","espXlinea","gCalUrl","id_cal","api_key","gCalUrlShare","loc","window","location","pathName","pathname","substring","lastIndexOf","absolute","href","length","search","hash","urlapi","hrefapi","apiConfig","buscarEventos","fetch","then","response","json","datos","mostrarEventos","catch","error","console","finally","log","summary","description","updated","items","nodato","formularioId","document","querySelector","undefined","mostrarAlerta","code","mensaje","alerta","createElement","textContent","classList","add","appendChild","setTimeout","remove"],"mappings":"AAEA,IAAIA,QAAU,EACVC,KAAM,IAAIC,MAAOC,SACjBC,OAAS,IAAIF,KACbG,QAAU,qBACVC,SAAW,oBACXC,UAAY,qBAEZC,QAAU,oDAAoDC,qBAAqBC,sBAAsBV,qCAAqCC,wBAC9IU,aAAe,4CAA4CF,OAE3DG,IAAMC,OAAOC,SACbC,SAAWH,IAAII,SAASC,UAAU,EAAGL,IAAII,SAASE,YAAY,KAAO,GACrEC,SAAWP,IAAIQ,KAAKH,UAAU,EAAGL,IAAIQ,KAAKC,SAAWT,IAAII,SAAWJ,IAAIU,OAASV,IAAIW,MAAMF,OAASN,SAASM,SAE7GG,OAAS,0EACTC,QAAU,GAAGN,WAAWK,SACxBE,UAAYD,QAEhB,SAASE,gBACLC,MAAMpB,SACLqB,KAAKC,GAAYA,EAASC,QAC1BF,KAAKG,IAEFC,eAAeD,KAElBE,MAAMC,IACHC,QAAQD,MAAM,UAAUA,KAG3BE,QAAQ,KACLD,QAAQE,IAAI,2CAIpB,SAASL,eAAeD,GACDA,EAAMO,QACVP,EAAMQ,YACDR,EAAMS,QACbT,EAAMU,MAHnB,MAIMC,EAASX,EAAMG,MAGfS,EAAeC,SAASC,cAAc,WAM5C,GALAV,QAAQE,IAAIN,GACZI,QAAQE,IAAIK,GACZP,QAAQE,IAAI,WAAa7B,QACzB2B,QAAQE,IAAI,YAAc5B,SAEZqC,MAAVJ,EAAqB,CACrB,GAAe,KAAXlC,QAA6B,KAAZC,QAEjB,YADAsC,EAAc,8DAA8D,GAEzE,GAAyB,MAArBhB,EAAMG,MAAMc,MAA4B,KAAZvC,QAEnC,YADAsC,EAAc,kDAAkD,GAE7D,GAAe,KAAXvC,QAAsC,MAArBuB,EAAMG,MAAMc,KAEpC,YADAD,EAAc,kDAAkD,GAE7D,GAAe,KAAXvC,QAAsC,MAArBuB,EAAMG,MAAMc,KAEpC,YADAD,EAAc,kDAAkD,GAE7D,GAAyB,MAArBhB,EAAMG,MAAMc,MAA4B,KAAZvC,QAEnC,YADAsC,EAAc,+CAA+C,GAE1D,GAAyB,MAArBhB,EAAMG,MAAMc,KAEnB,YADAD,EAAc,gCAAgC,GAE3C,GAAwC,MAArBhB,EAAMG,MAAMc,KAElC,YADAD,EAAc,mDAAmD,GAE9D,GAAyB,MAArBhB,EAAMG,MAAMc,KAEnB,YADAD,EAAc,sBAAsB,GAO5C,SAASA,EAAcE,EAASf,EAAQ,MACpC,MAAMgB,EAAUN,SAASO,cAAc,KACvCD,EAAOE,YAAcH,EAEjBf,EACAgB,EAAOG,UAAUC,IAAI,WAErBJ,EAAOG,UAAUC,IAAI,cAGzBX,EAAaY,YAAYL,GAEzBM,WAAW,KACPN,EAAOO,UACR,KACHtB,QAAQE,IAAIa,GAjBhBH,EAAc,wCAoBdZ,QAAQE,IAAI,mBAAmB9B,SAKnCmB","file":"eventos.js","sourcesContent":["//let id_cal = \"35b2qba53usalutistin2t916o@group.calendar.google.com\";\r\n//let api_key = \"AIzaSyB4x70PYpmslKqPy_fvvoMMTKADc9UdifE\";\r\nlet maxitem = 4;\r\nlet now = new Date().toJSON();\r\nlet actual = new Date();\r\nlet espXmas = \".replace(' ', '+')\";\r\nlet espXnada = \".replace(' ', '')\";\r\nlet espXlinea = \".replace(' ', '-')\";\r\n\r\nlet gCalUrl = `https://www.googleapis.com/calendar/v3/calendars/${id_cal}/events?key=${api_key}&maxResults=${maxitem}&orderBy=startTime&timeMin=${now}&singleEvents=true`;\r\nlet gCalUrlShare = `http://www.google.com/calendar/embed?src=${id_cal}`\r\n\r\nlet loc = window.location;\r\nlet pathName = loc.pathname.substring(0, loc.pathname.lastIndexOf('/') + 1);\r\nlet absolute = loc.href.substring(0, loc.href.length - ((loc.pathname + loc.search + loc.hash).length - pathName.length));\r\n//let urlapi = \"../wp-content/plugins/gCal-events-wp/admin/build/api/apikey.php\";\r\nlet urlapi = \"../wp-content/plugins/gCal-events-wp/admin/build/json/fondo_config.json\";\r\nlet hrefapi = `${absolute}${urlapi}`;\r\nlet apiConfig = hrefapi;\r\n\r\nfunction buscarEventos() {\r\n    fetch(gCalUrl)\r\n    .then(response => response.json())\r\n    .then(datos => {\r\n        //console.table(datos);\r\n        mostrarEventos(datos);\r\n    })\r\n    .catch(error => {\r\n        console.error(`ERROR: ${error}`);\r\n        //console.error(\"ERROR: \" + error);\r\n    })\r\n    .finally(() => {\r\n        console.log(\"Ha Terminado de consultar los Eventos\");\r\n    })\r\n}\r\n\r\nfunction mostrarEventos(datos){\r\n    const calendario = datos.summary;\r\n    const calDes = datos.description;\r\n    const actualizado = datos.updated;\r\n    const item = datos.items;\r\n    const nodato = datos.error;\r\n    const idval = 1;\r\n    const keyval = 1;\r\n    const formularioId = document.querySelector('.id-key');\r\n    console.log(datos);\r\n    console.log(nodato);\r\n    console.log(\"id_cal: \" + id_cal);\r\n    console.log(\"api_key: \" + api_key);\r\n\r\n    if (nodato != undefined) {\r\n        if (id_cal === '' && api_key === '') {\r\n            mostrarAlerta(`Introduzca el El Id del Calendario y la Api-Key de Google.`, true);\r\n            return;\r\n        } else if (datos.error.code === 404 && api_key === '') {\r\n            mostrarAlerta(`Id del Calendario no valido. \\n Api-Key vacío.`, true);\r\n            return;\r\n        } else if (id_cal === '' && datos.error.code === 404) {\r\n            mostrarAlerta(`Api-Key no válido. \\n Id del Calendario vacío.`, true);\r\n            return;\r\n        } else if (id_cal === '' && datos.error.code === 400) {\r\n            mostrarAlerta(`Api-Key no válido. \\n Id del Calendario vacío.`, true);\r\n            return;\r\n        } else if (datos.error.code === 403 && api_key === '') {\r\n            mostrarAlerta(`Api-Key vacío. \\n Id del Calendario Valido.`, true);\r\n            return;\r\n        } else if (datos.error.code === 404) {\r\n            mostrarAlerta(`Id del Calendario no valido.`, true);\r\n            return;\r\n        } else if (idval === 1 && datos.error.code === 400) {\r\n            mostrarAlerta(`Api-Key no válido. \\n Id del Calendario Valido.`, true);\r\n            return;\r\n        } else if (datos.error.code === 400) {\r\n            mostrarAlerta(`Api-Key no válido.`, true);\r\n            return;\r\n        }\r\n    }\r\n\r\n    mostrarAlerta(`Id de Calendario y Api Key Correctos`);\r\n\r\n    function mostrarAlerta(mensaje, error = null) {\r\n        const alerta =  document.createElement('P');\r\n        alerta.textContent = mensaje;\r\n\r\n        if (error) {\r\n            alerta.classList.add('errorid');\r\n        } else {\r\n            alerta.classList.add('correctoid');\r\n        };\r\n\r\n        formularioId.appendChild(alerta);\r\n\r\n        setTimeout(() => {\r\n            alerta.remove();\r\n        }, 8000);\r\n        console.log(alerta);\r\n    }\r\n\r\n    console.log(`Datos del gCal: ${gCalUrl}`);\r\n}\r\n\r\n\r\n\r\nbuscarEventos();\r\n"]}